<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>
    <link rel="stylesheet" href="/public/employee/css/host.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: unset;
            padding: unset;
        }
        body {
            background: rgb(0, 109, 243);
            background-size: cover;
        }
        .container-wrapper-1 {
            border-radius: 10px;
            width: 90%;
            max-width: 250px;
            max-height: 350px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            padding: 50px 60px 70px;
            text-align: center;
        }
        /* */
        .input input {
            width: 240px;
            height: 35px;
            margin-top: 20px;
            background-color: transparent;
            border-bottom: 1px solid black;
            border-top: none;
            border-right: none;
            border-left: none;
        }
        input::placeholder{
            padding: 0px;
            border: none;
        }
        .button {
            margin-top: 30px;
            width: 80%;
            height: 5vh;
            border: none;
            border-radius: 50px;
            background-image: linear-gradient(90deg, hsl(197deg 100% 63%) 0%, hsl(208deg 100% 60%) 17%, hsl(294deg 100% 55%) 100%);
        }
        .fa-solid {
            margin-top: -20px;
        }
        .button a {
            color: white;
            text-decoration: none;
        }
        .sign-up {
            margin-top: 5%;
            color: rgb(0, 0, 0);
        }
        .sign-up a {
            text-decoration: none;
            color: black;
            font-weight: 20;
        }
    </style>
</head>
<body>
    <div class="container-wrapper-1">
        <div class="x">
            <h1>Sign up To Ebrad</h1>
        
        </div>
        <form method="post" action="/host" id="userForm">
            <div class="input">
                <input type="text" name="name" placeholder="Name">
                <input type="email" name="email" placeholder="Email">
                <input type="text" name="role"placeholder="Role">
                <input type="password" name="password" placeholder="Password">
                <input type="password" name="confirmPassword" placeholder="Confirm Password">
            </div>
            <button class="button" id="submitBtn" type="submit">
                <a href="#">SIGN UP</a>
            </button>
            <div class="sign-up">
                <p>Already have an account? <a href="/login.html">Log In</a></p>
            </div>
        </form>
    </div>
    <script>
    function validateFormData(data) {
  const requiredFields = ['name', 'role', 'email', 'password', 'confirmPassword'];

  for (const field of requiredFields) {
    if (!data[field]) {
      throw new Error(`Validation failed: ${field} is required.`);
    }
  }

  // Additional validation checks (optional)
  if (data.password !== data.confirmPassword) {
    throw new Error('Passwords do not match.');
  }

  
}

function showConfirmationDialog(data) {
  const confirmationMessage = `
    Please confirm your details:
    Name: ${data.name}
    Role: ${data.role}
    Email: ${data.email}
    Password: ${data.password}
    Confirm Password: ${data.confirmPassword}
  `;

  return confirm(confirmationMessage);
}

const submitBtn = document.getElementById('submitBtn');
submitBtn.addEventListener('click', async (event) => {
  try {
    event.preventDefault();

    const formData = new FormData(document.getElementById('userForm'));
    const data = Object.fromEntries(formData.entries());

    validateFormData(data);

    if (showConfirmationDialog(data)) {
      const jsonData = JSON.stringify(data);

      const response = await fetch('http://localhost:8002/api/users2', {
        method: 'POST',
        body: jsonData,
        headers: {
          'Content-Type': 'application/json'
        }
      });

      if (!response.ok) {
        const errorData = await response.text();
        console.error('Error:', errorData);
        alert(`Error: ${errorData}`);
        return;
      }

      const user = await response.json();
      console.log('User created:', user);
      alert('Welcome! Thank you for registering. We are excited to have you here. You can now proceed to check your vistors.');
    } else {
      alert('Form submission canceled.');
    }
  } catch (error) {
    console.error('Error:', error.message);
    alert(error.message);
  }
});
window.location.href = `/dashboard.html?name=${host.name}`

    </script>
</body>
</html>